{"ast":null,"code":"/**\n * Chat Service - Handles API communication with the backend\n * Uses Server-Sent Events (SSE) for real-time streaming\n */\n\n// Use direct backend URL to avoid CRA proxy buffering SSE responses\nconst API_BASE_URL = process.env.NODE_ENV === 'development' ? 'http://localhost:8080' : '';\n\n/**\n * Stream chat messages from the backend using SSE\n * @param {string} message - The user's message\n * @param {function} onMessage - Callback function for each message chunk\n * @param {function} onComplete - Callback function when streaming is complete\n * @param {function} onError - Callback function for errors\n * @returns {EventSource} The EventSource instance for cleanup\n */\nconst streamChat = (message, onMessage, onComplete, onError) => {\n  // Connect directly to backend to avoid proxy buffering SSE\n  const url = `${API_BASE_URL}/chat?message=${encodeURIComponent(message)}`;\n  const eventSource = new EventSource(url);\n\n  // Handle 'message' events - these contain the streamed tokens\n  eventSource.addEventListener('message', event => {\n    try {\n      const data = JSON.parse(event.data);\n      if (data.content) {\n        onMessage(data.content);\n      }\n    } catch (error) {\n      console.error('Error parsing SSE data:', error);\n    }\n  });\n\n  // Handle 'complete' event - signals end of stream\n  eventSource.addEventListener('complete', event => {\n    eventSource.close();\n    onComplete();\n  });\n\n  // Handle connection errors\n  eventSource.onerror = error => {\n    console.error('SSE connection error:', error);\n    eventSource.close();\n    onError(error);\n  };\n\n  // Return the eventSource so caller can close it if needed\n  return eventSource;\n};\nexport const chatService = {\n  streamChat\n};","map":{"version":3,"names":["API_BASE_URL","process","env","NODE_ENV","streamChat","message","onMessage","onComplete","onError","url","encodeURIComponent","eventSource","EventSource","addEventListener","event","data","JSON","parse","content","error","console","close","onerror","chatService"],"sources":["/Users/umashav1/Study/chat-sse-app/frontend/src/services/chatService.js"],"sourcesContent":["/**\n * Chat Service - Handles API communication with the backend\n * Uses Server-Sent Events (SSE) for real-time streaming\n */\n\n// Use direct backend URL to avoid CRA proxy buffering SSE responses\nconst API_BASE_URL = process.env.NODE_ENV === 'development' \n  ? 'http://localhost:8080' \n  : '';\n\n/**\n * Stream chat messages from the backend using SSE\n * @param {string} message - The user's message\n * @param {function} onMessage - Callback function for each message chunk\n * @param {function} onComplete - Callback function when streaming is complete\n * @param {function} onError - Callback function for errors\n * @returns {EventSource} The EventSource instance for cleanup\n */\nconst streamChat = (message, onMessage, onComplete, onError) => {\n  // Connect directly to backend to avoid proxy buffering SSE\n  const url = `${API_BASE_URL}/chat?message=${encodeURIComponent(message)}`;\n  const eventSource = new EventSource(url);\n\n  // Handle 'message' events - these contain the streamed tokens\n  eventSource.addEventListener('message', (event) => {\n    try {\n      const data = JSON.parse(event.data);\n      if (data.content) {\n        onMessage(data.content);\n      }\n    } catch (error) {\n      console.error('Error parsing SSE data:', error);\n    }\n  });\n\n  // Handle 'complete' event - signals end of stream\n  eventSource.addEventListener('complete', (event) => {\n    eventSource.close();\n    onComplete();\n  });\n\n  // Handle connection errors\n  eventSource.onerror = (error) => {\n    console.error('SSE connection error:', error);\n    eventSource.close();\n    onError(error);\n  };\n\n  // Return the eventSource so caller can close it if needed\n  return eventSource;\n};\n\nexport const chatService = {\n  streamChat\n};\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA;AACA,MAAMA,YAAY,GAAGC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,GACvD,uBAAuB,GACvB,EAAE;;AAEN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,UAAU,GAAGA,CAACC,OAAO,EAAEC,SAAS,EAAEC,UAAU,EAAEC,OAAO,KAAK;EAC9D;EACA,MAAMC,GAAG,GAAG,GAAGT,YAAY,iBAAiBU,kBAAkB,CAACL,OAAO,CAAC,EAAE;EACzE,MAAMM,WAAW,GAAG,IAAIC,WAAW,CAACH,GAAG,CAAC;;EAExC;EACAE,WAAW,CAACE,gBAAgB,CAAC,SAAS,EAAGC,KAAK,IAAK;IACjD,IAAI;MACF,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACC,IAAI,CAAC;MACnC,IAAIA,IAAI,CAACG,OAAO,EAAE;QAChBZ,SAAS,CAACS,IAAI,CAACG,OAAO,CAAC;MACzB;IACF,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IACjD;EACF,CAAC,CAAC;;EAEF;EACAR,WAAW,CAACE,gBAAgB,CAAC,UAAU,EAAGC,KAAK,IAAK;IAClDH,WAAW,CAACU,KAAK,CAAC,CAAC;IACnBd,UAAU,CAAC,CAAC;EACd,CAAC,CAAC;;EAEF;EACAI,WAAW,CAACW,OAAO,GAAIH,KAAK,IAAK;IAC/BC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;IAC7CR,WAAW,CAACU,KAAK,CAAC,CAAC;IACnBb,OAAO,CAACW,KAAK,CAAC;EAChB,CAAC;;EAED;EACA,OAAOR,WAAW;AACpB,CAAC;AAED,OAAO,MAAMY,WAAW,GAAG;EACzBnB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}